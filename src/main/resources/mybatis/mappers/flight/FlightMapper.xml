<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="clone.asiana.asiana_clone.flight.mapper.FlightMapper">

    <select id="departureAirport" resultType="string">
        select
        departure_airport as departureAirport
        from flights.flights
        where departure_airport is not null
        group by departure_airport
    </select>

    <select id="arrivalAirport" resultType="string">
        select
        arrival_airport as arrivalAirport
        from flights.flights
        where arrival_airport is not null
        group by arrival_airport
    </select>

    <select id="flightsSearch" resultType="clone.asiana.asiana_clone.flight.vo.FlightStatusVO">
        select
            a.flight_number,
            a.departure_airport as departureAirport,
            a.arrival_airport as arrivalAirport,
            a.departure_time as departureDate,
            a.arrival_time,
            b.status
        from flights.flights as a
        join flights.flight_status as b on a.flight_id = b.flight_id
        where 1=1
        <if test="departureAirport != null and departureAirport != ''">
            and a.departure_airport = #{departureAirport}
        </if>
        <if test="arrivalAirport != null and arrivalAirport != ''">
            and a.arrival_airport = #{arrivalAirport}
        </if>
    </select>


</mapper>